# Elgamal的数字签名方案
签名方案：签名是一个验证过程，和公钥加密方案相反，签名可以理解成一对多的过程。在签名方案中，发送方用自己的私钥签名，接收方用公钥验证。

EG签名方案本质也是加解密的过程，接收方去验证解密后的消息和原消息是否相同，从而保证消息的完整性和真实性。

Elgamal如何实现数字签名概括为三个部分：公钥生成、签名、验签
# 1、公钥生成
这里的公钥生成和EG公钥密码体制差不多，Alice选择一个素数 $q$和其原根 $a$，用一个随机私钥 $X_A(0<X_A<q-1)$，$X_A$ 相当于密钥1。生成公钥：
$$Y_A=a^{X_A}modq$$
Alice会将 $（Y_A,a,q）$作为一组公钥公布出去。
# 2、签名
Alice对消息 $m$进行签名，首先Alice会选一个随机数 $k$（相当于密钥2），用 $k$进行以下签名：
$$sig_k(m,k)=(r,s)$$
其中：
$$r=a^kmodq, s=(m-X_A*r)k^{-1}mod(q-1)$$
签名完成后，Alice会将 $（m,r,s）$作为一组签名公布出去
# 3、验签
Bob拿到Alice的公钥和签名之后，以下式子成立则完成验签：
$$Y_A^r*r^s=a^mmodq$$
# 4、推导
我们从验证公式反推签名，看下为什么上面这个式子能证明签名成功。
首先验签公式可以写成如下：
$$a^m=Y_A^r*r^smodq$$
我们把 $Y_A$和 $r$展开，但是指数上的 $r$不展开：
$${Y_A}^r=(a^{X_A}modq)^r,r=(a^kmodq)^s$$
将其带入到上面的验签公式中：
$$a^m=a^{X_A*r}modq*a^{k*s}modq=a^{X_A*r+k*s}modq$$
因为 $a$是模 $q$的本原元，因此，当且仅当指数是一个模 $q-1$的等式，即当：
$$m=(X_A*r+k*s)mod (q-1)$$
时，上式成立。所以：
$$ s=(m-X_A*r)k^{-1}mod(q-1)$$
# 5、总结

Alice使用私钥 $X_A$生成公钥 $Y_A$和一个随机数 $k$（可以看成私钥2）计算签名，然后公开6个参数 $(Y_A,a,q)$ 和 $(m,r,s)$，对方则可完成验签。

**本质上还是一个解密看解密后的 $m'$是否和原来的 $m$保持一致的过程。**

**在链上交易中，可以利用EG进行签名，这个签名包括两部分，一个是账户信息的签名，一个是交易金额的签名。各个想进行交易的人对其签名，然后系统或者对方进行验签。**