# 基于椭圆曲线的Elgamal公钥加密
# 1、公私钥生成
设E是建立在有限域 $F_q$上的一条椭圆曲线。在ECDSA中，选择椭圆曲线的参数 $ D=(q,a,b,G,n,h)$,其中：
- a，b是椭圆曲线方程的参数，a,b在有限域中
- G为 $E(F_q)$的一个基点，
- n为基点G的阶数: $O(G)=n > max(2^{160},4\sqrt{q}) $
- h为余因子，且 $h=E（F_q）mod n$
随机选择一个整数 $s（0 < s < n）$ 作为私钥保密，定义 $Q=d*G$ 作为公钥。
则: $(E(F_q),G,Q)$ 作为公钥，s为私钥
注：一般来说私钥随机数的生成需要一个伪随机函数和随机种子。
# 2、加密
假设 $m$是哈希后的待签名消息，任意选取随机数 $k$， $1 <= k <= n$， 计算  $X1=k*G$ （G是上面说的基点）， $X2=k*Q$。加密：
$$C=m*X2(mod n)$$

输入：签名消息 $m$，随机数 $k$，椭圆曲线的基点 $G$，公钥Q
输出： $(X1,C)$，注意：这里需要把 $X2$ 也公布出去
注：这里的 $X1$ 和 $X2$ 实际是坐标，因为 $G$是坐标
# 3、解密
先用用私钥d求出 $X2=d*X1$ ,接着 $m=C*X2^{-1}(mod n)$

# 4、总结
一般来讲，选定了椭圆曲线， $G，p，a,b$ 等值会自然确定。一般在算法中，只需要输入对应的椭圆曲线，NIST向社会推荐了5条素域 $GF(p)$ 上随机选取的椭圆曲线：

## P192

 p=2192-264-1

 a=-3

 b=64210519 E59C80E7 0FA7E9AB 72243049 FEB8DEEC C146B9B1

 x=188DA80E B03090F6 7CBf20EB 43A18800 F4FF0AFD 82FF1012

 y=07192B95 FFC8DA78 631011ED 6B24CDD5 73F977A1 1E794811

 n=FFFFFFFF FFFFFFFF FFFFFFFF 99DEF836 146BC9B1 B4D22831

 h=1

## p-224

 p=2224-296-1

 a=-3

 b=B4050A85 0C04B3AB F5413256 5044B0B7 D7BFD8BA 270B3943 2355FFB4

 x=B70E0CBD 6BB4BF7F 321390B9 4A03C1D3 56C21122 343280D6 115C1D21

 y=BD376388 B5F723FB 4C22DFE6 CD4375A0 5A074764 44D58199 85007E34

 n=FFFFFFFF FFFFFFFF FFFFFFFF FFFF16A2 E0B8F03E 13DD2945 5C5C2A3D

 h=1

## p-556

 p=2256-2224+2192+296-1

 a=-3

 b=5AC635D8 AA3A93E7 B3EBBD55 769886BC 651D06B0 CC53B0F6 3BCE3C3E 27D2604B
 
 x=6B17D1F2 E12C4247 F8BCE6E5 63A440F2 77037D81 2DEB33A0 F4A13945 D898C296
 
 y=4FE342E2 FE1A7F9B 8EE7EB4A 7C0F9E16 2BCE3357 6B315ECE CBB64068 37BF51F5
 
 n=FFFFFFFF 00000000 FFFFFFFF FFFFFFFF BCE6FAAD A7179E84 F3B9CAC2 FC632551
 
 h=1

## p-384
 
 p=2384-2128-296+232-1
 
 a=-3
 
 b=B3312FA7 E23EE7E4 988E056B E3F82D19 181D9C6E FE814112 0314088F 5013875A C656398D 
 8A2ED19D 2A85C8ED D3EC2AEF
 
 x=AA87CA22 BE8B0537 8EB1C71E F320AD74 6E1D3B62 8BA79B98 59F741E0 82542A38 5502F25D BF55296C 3A545E38 72760AB7
 
 y=3617DE4A 96262C6F 5D9E98BF 9292DC29 F8F41DBD 289A147C E9DA3113 B5F0B8C0 0A60B1CE 1D7E819D 7A431D7C 90EA0E5F
 
 n=FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF C7634D81 F4372DDF 581A0DB2 48B0A77A ECEC196A CCC52973
 
 h=1
## p-521
 
 p=2521-1
 
 a=-3
 
 b=00000051 953EB961 8E1C9A1F 929A21A0 B68540EE A2DA725B 99B315F3 B8B48991 8EF109E1 
 56193951 EC7E937B 1652C0BD 3BB1BF07 3573DF88 3D2C34F1 EF451FD4 6B503F00
 
 x=000000C6 858E06B7 0404E9CD 9E3ECB66 2395B442 9C648139 053FB521 F828AF60 6B4D3DBA A14B5E77 EFE75928 FE1DC127 A2FFA8DE 3348B3C1 856A429B F97E7E31 C2E5BD66
 
 y=00000118 39296A78 9A3BC004 5C8A5FB4 2C7D1BD9 98F54449 579B4468 17AFBD17 273E662C 97EE7299 5EF42640 C550B901 3FAD0761 353C7086 A272C240 88BE9476 9FD16650
 
 n=000001FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF 51868783 BF2F966B 7FCC0148 F709A5D0 3BB5C9B8 899C47AE BB6FB71E 91386409
 
 h=1