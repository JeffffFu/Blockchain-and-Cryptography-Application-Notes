# Elgamal乘法同态
基于EG的公钥加密的基础上，有乘法同态的性质如下：

在上面的EG公钥加密方案中，假设我们要加密两个消息m1和m2，Bob选定的私钥分别是 $X_{B1}$ 和 $X_{B2}$，我们可以将加密方案分别写成：

$$E（m1）=(a^{X_{B1}}modq,m1*Y_A^{X_{B1}}modq)$$

$$E（m2）=(a^{X_{B2}}modq,m1*Y_A^{X_{B2}}modq)$$

以上公式我们省略了中间符号，前一项是Bob需要公布的密钥协商部分，后面一项是根据Alice密钥私钥部分和自己的私钥加密的密文。所以两个相乘如下：

$$E（m1）*E（m2）=(a^{X_{B1}+X_{B2}}modq,m1*m2*Y_A^{X_{B1}+X_{B2}}modq)$$

如果对于明文 $m1,m2$ 他们相乘后再EG公钥加密，Bob的私钥为 $X_{B1}+X_{B2}$如下：

$$E（m1*m2）=(a^{X_{B1}+X_{B2}}modq,m1*m2*Y_A^{X_{B1}+X_{B2}}modq)$$

我们可以看到：

$$E(m1)*E(m2)=E(m1*m2)$$

即Elgamal公钥加密满足乘法同态性，注意这里的私钥加密是加法的。
即相当于用 $X_{B1}+X_{B2}$随机数对 $m1*m2$ 加密,即ElGamal加密满足乘法同态，而且，该乘法同态没有次数限制。可以进行任意次乘法运算。